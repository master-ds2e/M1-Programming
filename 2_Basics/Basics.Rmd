---
title: "Basics"
author: "Pierre Pelletier"
date: "3 septembre 2020"
output:
  html_document:
    toc: true
    number_sections: true
    toc_float:
      collapsed: false
      smooth_scroll: true
---


```{css, echo=FALSE}
#.r-chunk {
#  background-color: lightpink;
#}
#
#.py-chunk {
#  background-color: lightblue;
#}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,error=TRUE,collapse = TRUE)
library(reticulate)

#  md_document:
#    variant: markdown_github
#
#
#<div class = "row">
#<div class = "col-md-6">
#<div class = "python">
#  
#
#</div>
#</div>
#<div class = "col-md-6">
#<div class = "r">  
#  
#  
#</div>
#</div>
#</div>


#<style>
#div.blue pre { background-color:lightblue; }
#div.blue pre.r { background-color:blue; }
#</style>
#
```

<style>
div.python pre { background-color: #fdfcff; }
</style>

<style>
div.r pre { background-color: #fffffc; }
</style>

# Operations

## Arithmetic Operations
Python and R can both work as classical calculator, using "+", "-", "*" and "/" you can do arithmetic operations in both language.

<div class = "row">
<div class = "col-md-6">
<div class = "python">

```{python , collapse = T}
# Python 

1+2
1-2
1/2
1*2

```

</div>
</div>
<div class = "col-md-6">
<div class = "r">

```{r, collapse = TRUE}
# R

1+2
1-2
1/2
1*2
```

</div>
</div>
</div>

You can also apply exponantiation, Modulo and floor division easily in both language. Please note that in R you can writte the exponantiation "^". You cannot do that in Python (it is used for antoher operation) but both use "**" for exponantiation. Use this one for clarity.


<div class = "row">
<div class = "col-md-6">
<div class = "python">

```{python,echo = T,collapse = TRUE}
# Python 

2**8 # exponantiation
2^8 == 2**8 # False
8%3 # modulo
8//3 # floor division
```

</div>
</div>
<div class = "col-md-6">
<div class = "r">

```{r,echo=T,collapse = TRUE}
# R

2**8 # exponantiation
2^8 == 2**8 # TRUE
8%%3 # modulo
8%/%3 # floor division

```

</div>
</div>
</div>

##  Comparison Operators

In order to compare some values we can use comparison operators to investigate in a given value is equal to, not equal, greater than ... etc

Theses operators are the same in both language.


<div class = "row">
<div class = "col-md-6">
<div class = "python">
```{python,echo = T,collapse = TRUE}
# Python 

2==8
2!=8
2<8
2>8
2<=8

```

</div>
</div>
<div class = "col-md-6">
<div class = "r">
```{r,echo=T,collapse = TRUE}
# R

2==8
2!=8
2<8
2>8
2<=8
```
</div>
</div>
</div>

# Objects & Variables

ref used : https://www.practicaldatascience.org/html/vars_v_objects.html

Variables are used to store data. In Python and R, we do not need to declare a variable before assigning a value to this variable. You can think of a variable as a name to refers to an object. There is a big difference between python and R on the way the computer is storing object and variables that we will see in the end of the section.



## Difference between R and Python


In R, a variable and an object are the same things, they refers to the same entities. If you assign to a new variable a variable that already exist, it will refers to two different objects.

Things in Python are more conventional, but since some people learned R before Python it's important to notice that variables refers to an objet but they are still two entities. It means that two variables can refer to a single object. If two variables are pointing the same object, the modification made with one variable will be also available when using the other variable.There some 
In R two variable can refers to the same object, but once one variable is changed, a new space in the memomry is allocated to a new object.
However not all data-type of Python are muttable. Examples are provided later.



## textual and numerical variables

In R textual data are called 'character', in Python it is a string, abbreviate as 'str'. " or ' are used when you set a textual variable in both laguage, but you can also set a variable to textual variable if needed.

Numerical variables a decomposed in three types. In Python you'll have integer, float and complex. In R float is called 'double', reffering to double precision floating point. Without entering into details it means that the number have a precision up to 15 decimals. Float can refers to a precision of 7 decimals, however in Python the data-type 'float' has a precision of 15 numbers. They are ways to get more precisions using Numpy for example. 

Finaly you can check easily the data-type of the variable that you are dealing by asking the language with the command 'type' in Python, or 'typeof' in R.

<div class = "row">
<div class = "col-md-6">
<div class = "python">
```{python,echo = T,collapse = TRUE}
# Python 

import sys 
sys.float_info.dig # number of decimals

a = 1
type(a)

b = 1.1
type(b)

c = 1.1+2j
type(c)

d = 'd'
type(d)

# change the type
e = 2
f = str(e)
f
float(f)
```

</div>
</div>
<div class = "col-md-6">
<div class = "r">

```{r,echo=T,collapse = TRUE}
# R

a = 1
typeof(a)
a_int = 1L
typeof(a_int)

b = 1.1
typeof(b)

c = 1.1+2i
typeof(c)

d = 'd'
typeof(d)

# change the type
e = 2
f = as.character(e)
f
as.numeric(f)
```
</div>
</div>
</div>

## Other Data-Type (R)
https://www.statmethods.net/input/datatypes.html

There is a lot of datatype in both language that we will discover along the course, for now we will focus only on basic data-type that are directly available without using anyother package or library,in R common data-type are Vector, Matrix, List, Data frame and factor.


### Vectors and Matrices

<div class = "r">

<div class = "row">
<div class = "col-md-6">

```{r}
# R

vec = c(1, 2, 3)
length(which(vec==2)) # count elements of the list which are exactly equal to 2

vec = sort(vec,
           decreasing = TRUE)
vec
# access the element of a list
vec[1]
vec[which(vec==3)]
vec[2:length(vec)]
vec[length(vec):2]
vec[-1] # throwaway value


```

</div>
<div class = "col-md-6">

```{r}
# R

mat = matrix(c(1, 2, 3, 4, 5, 6),3,2)
dim(mat)
mat

length(which(mat==2)) # count elements of the list which are exactly equal to 2

vec = sort(mat,
           decreasing = TRUE)
vec
# access the element of a list
mat[1] # first element
which(mat==3,
      arr.ind = TRUE) # get row and columns for each value that match

mat[2:length(mat)] # gives you a vector
mat[2:dim(mat)[1],]
mat[length(mat):1]

mat[1,-1] # throwaway values


```

</div>
</div>

```{r}
# modify

b = rep(0,3)
vec = c(vec,b)
vec
mat_2 = rbind(vec,vec)
mat_2 
mat_2 = cbind(mat_2,mat_2)
mat_2

t_mat = t(mat) # transposition
t_mat[2,3] = as.character(t_mat[2,3]) # all values turn to character


i_mat = diag(1, 3)
i_mat


```


</div>

### Data frame

A Data frame in R is a matrix which can store different type of data, characters, numerics or factors. Contrary to the matrix it does not have a fixed dimension it means that you can create a column very easily using the operator '$'.

<div class = "r">

```{r,echo=T,collapse = TRUE}
# Python

df = data.frame(chr = letters[1:5], # letters is a vector of letter provided directly in R
                num = seq(1,5,1),
                fac = factor(c(rep('a',3),rep('b',2)))) 
class(df$chr) # automaticaly converted to factor, which can be very inneficient !
df$chr = as.character(df$chr)
class(df$chr)
colnames(df)
df
# access the element of a variable in a df
df$chr[3]
which(df==3,
      arr.ind = TRUE) 

df[1:2] # gives you a df with the first two columns !
df[3:dim(df)[1],]

df[1,-1] # throwaway values

```
```{r,echo = T,collapse = TRUE}
# modify

b = rep(0,3)
df = rbind(df,b) # introduce a new row in the data frame, note that we get a NA in the factor colmun because '0' is not a level
df$new_col = rep(2,6) # you can introduce new colmuns by specifiying the name and set a value


df
t_df = t(df) # transposition convert the df into a matrix
class(t_df)
```
</div>

### Arrays

Arrays is a generalisation of the matrix, it means that you can have more than two dimension. You can modify them as you modify a matrix.

<div class = "r">

```{r,echo=T,collapse = TRUE}
# Python

arr = array(seq(1,12,1), dim = c(2,2,3)) # create a matrix with 3 dimension
arr
# access the element of a dictionary
arr[1,,]
arr[,1,]
arr[,,1]
```
</div>

### Lists 

A list permits you to assemble an assortment of disconnected objects behind one variable, it is also possible to store objects which can be of different types.


<div class = "r">

```{r,echo=T,collapse = TRUE}
# Python

lst = list(df = df,
           mat = mat,
           arr = arr) # create a matrix with 3 dimension

lst
lst[[1]] # first element of the list, here it is the df
lst[[1]][1,] # first row of first element of the list
```
</div>



## Other Data-Type (Python)

refused : https://thomas-cokelaer.info/tutorials/python/lists.html

In Python the most common are List, Turple, sets, Dictionnary.
Note that for the moment when modifiying a variable we always use '='. Keep in mind that using the '.' can modify the object behind the variable in Python.

### Lists 

Keep in mind that Lists are mutable, as discussed in the Section "Difference between R and Python"

<div class = "python">
```{python,echo = T,collapse = TRUE}
# Python

a = [1, 2, 3]
a.count(2) # count elements of the list which are exactly equal to 2

a.sort(reverse = True)
a
# access the element of a list
a[0]
a.index(3)
a[1:]
a[:1]
a[0:-1]
a[:]

```
```{python,echo = T,collapse = TRUE}
# modify

b = [0, 0, 0]
list(zip(a,b)) # zip will pairs the ellements, it works also with more than 2 element ex: zip(a,b,c)
a.append(b)
a
a[4:5] = ['a','b']
a
a.extend([4, 5, 6])
a
a += [7,8] # works as extend
a
a.insert(2,[1,2])
a
a.remove(b)
a

a = a*2 # replicate the list n times
len(a) # number of elements in the list

```
```{python,echo = T,collapse = TRUE}
# mutable

a = [1,2,3]
b = a
b[0] = 12
a

```
</div>

### Turples

The main difference between Lists and Turples is the fact that Turples is an immutable type of data making it faster to use.

<div class = "python">
```{python,echo=T,collapse = TRUE}
# Python

a = (1, 2, 3)
a.count(2) # count elements of the turple which are exactly equal to 2

a
# access the element of a turple
a[0]
a.index(3)
a[1:]
a[:1]
a[0:-1]
a[:]

```
```{python,echo = T,collapse = TRUE}

# modify
a += (4,5) 
a
a = a*2 # replicate the turple n times
len(a) # number of elements in the turple

```
```{python,echo = T,collapse = TRUE}
# immutable

a = (1,2,3)
b = a
b[0] = 12
a

```
</div>

### Dictionaries

Dictionary refers to a way of storing data that is not sorted. It works with key and value associate with this key.


<div class = "python">
```{python,echo=T,collapse = TRUE}
# Python

a = {'a':1, 'b':2, 'c':3}
# access the element of a dictionary
a.keys()
a['a']
a.values()
a.items()
a.get('a')
a.get('d',4) # set to 4 if the key 'd' is not detected

a.pop('a') # pop will use the corresponding value to the key a and remove the pair (key, value).
a
a.popitem('b')
a
```
```{python,echo = T,collapse = TRUE}
# modify
a['a'] =1 
a.setdefault('d',0) # create new item with a default value

b = {'d':4,'e':5}
a.update(b) # update values from other dict
a
a.clear() # remove all items

```
```{python,echo = T,collapse = TRUE}
# mutable

a = {'a':1, 'b':2, 'c':3}
b = a
b['b'] = [12,14]
a
```

</div>

### Sets

Sets are unordered collection of unique elements. If you give to a set multiple time the same element it will automatically delete dupplicated values.


<div class = "python">
```{python,echo=T,collapse = TRUE}
# Python

a = {1, 2, 3}
a
# access the element of a set

a[0] # since it unordered, you can not access to a given element of a set


```
```{python,echo = T,collapse = TRUE}
# modify
b = {3,4,5}
a.update(b)  # update values from other set
a

```
```{python,echo = T,collapse = TRUE}
# mutable

a = {'a':1, 'b':2, 'c':3}
b = a
b['b'] = [12,14]
a
```

</div>



# control flow

There are two main control flow tools: choices, and loops. 
choices are very useful for establishing rules or conditions. Choices can be used to modify a value according to a certain condition, generally it allows to launch certain actions in specific cases.
The loops when it allows to execute sequentially actions, it can be to interactively modify an object, more generally it allows to launch a procedure several times. You can for example create N similar objects but you can also modify the N lines of an object.


## Choices



<div class = "row">
<div class = "col-md-6">
<div class = "python">
```{python,echo = T,collapse = TRUE}
# Python 

# if, elif, else

n = 12

if n%2 == 0 :  
  print('n is an even number')
  



if n != int(n): 
  print('n is not a integer')
elif  n%2 == 0 :
  print('n is an even number')
else:
  print('n is not an even number')
  
  

  
```

</div>
</div>
<div class = "col-md-6">
<div class = "r">
```{r,echo=T,collapse = TRUE}
# R

# if, elif, else

n = 12L

if(n%%2 == 0){  
  print('n is an even number')
}
  



if(!is.integer(n)){ 
  print('n is not a integer')
  } else if(n%%2 == 0){
    print('n is an even number')
    } else {
      print('n is not an even number')
      }


  
```
</div>
</div>
</div>


## Loops

Using for loops, you will iterate over a predefined number of iteration, sometimes you don't know how many steps you need to perform a given task. Imagine that you want to optimize a function, you don't know how many step you need until reaching an optimum but you can set a condition for which you will consider that the algorithme as converged. For this kind of exercice you can use 'while' loops, it will iterate until a given condition is satisfied.


<div class = "row">
<div class = "col-md-6">
<div class = "python">
```{python,echo = T,collapse = TRUE}
# Python 

seq = [1,2,None,4,None,6]
total = 0

for val in seq:
  if val is not None:
    total =+ val
    
total
```

```{python,echo = T,collapse = TRUE}
# Python 
import random

total = 0
while total < 1:
  rnd = random.gauss(mu = 0, sigma = 1)
  if rnd < 0:
    pass
  else:
    total =+ rnd
  
total

```

</div>
</div>

<div class = "col-md-6">
<div class = "r">
```{r,echo=T,collapse = TRUE}
# R
seq = c(1,2,NA,4,NA,6)
total = 0

for(val in seq){
  if(!is.na(val)){
    total =+ val
  }
}
    
total
```


```{r,echo = T,collapse = TRUE}
# R

total = 0

while(total < 1){
  rnd = rnorm(n=1, mean = 0, sd = 1)
  if(rnd < 0){
    # in R you can specify nothing instead of specifiying 'pass'
    } else {
    total =+ rnd }
}
  
total
```

</div>
</div>
</div>

## List, Set and Dict comprehensions (Python)

List comprehension is very common and appreciate in the python language features, think of it as a loop for which you will directly store output in a list, set, or dict. You can use it as a filter for exemple.


<div class = "python">

<div class = "row">
<div class = "col-md-6">
```{python,echo=T,collapse = TRUE}
# Python 
# List
import time

lst = [1,2,3,4]

t = time.time() 
results = []
for val in lst:
  if val > 2:
    results.append(val)
time.time()-t

results

t = time.time() 
# this loop their will produce the same output than a using List comprehension.
results = [val for val in lst if val>2]
time.time()-t

results
```
</div>
<div class = "col-md-6">
```{python,echo=T,collapse = TRUE}
# Python 
# Set
import time

st = {1,2,3,4}

t = time.time() 
results = set([])
for val in st:
  if val > 2:
    results.add(val)
time.time()-t

results

t = time.time() 

# this loop their will produce the same output than a using Set comprehension.
results = {val for val in st if val>2}
time.time()-t

results
```

</div>

<div class = "col-md-6">
```{python,echo=T,collapse = TRUE}
# Python 
# Dict
import time

dct = {'a':1,'b':2,'c':3,'d':4}

t = time.time() 
results = dict([])
for val in dct:
  if dct[val] > 2:
    results.update({str(val): dct[val]})
time.time()-t

results

t = time.time() 
# this loop their will produce the same output than a using Dict comprehension.
results = {str(val): dct[val] for val in dct if dct[val]>2}
time.time()-t

results
```

</div>
</div>



# Functions

Functions are very important in both language, being able to code yourself things are sometimes more efficient that looking for a package and understand it. Being able to write your own function gives you more flexibility and a better understanding of what you are actually doing. Most of the time, this sentence is wrong and the way you are googling things and reading documentation can also have a major role on ability to play with existent code. It's important to not reinvent the wheel, while it is important to be able to construct it yourself. Read documentation carefully while using packages, sometimes packages are misleading and you can spend a lot of time understanding how they work. Look at the packages source code when you are not sure of what the function does behind. The full power of programming comes with the fact that you can be autonomous by reading, exploiting and writing codes and pre-existing codes.


<div class = "row">
<div class = "col-md-6">
<div class = "python">
```{python,echo = T,collapse = TRUE}
# Python 

seq = [1,2,None,4,None,6]
total = 0

for val in seq:
  if val is not None:
    total =+ val
    
total
```

```{python,echo = T,collapse = TRUE}
# Python 
import random

total = 0
while total < 1:
  rnd = random.gauss(mu = 0, sigma = 1)
  if rnd < 0:
    pass
  else:
    total =+ rnd
  
total

```

</div>
</div>

<div class = "col-md-6">
<div class = "r">
```{r,echo=T,collapse = TRUE}
# R
seq = c(1,2,NA,4,NA,6)
total = 0

for(val in seq){
  if(!is.na(val)){
    total =+ val
  }
}
    
total
```


```{r,echo = T,collapse = TRUE}
# R

total = 0

while(total < 1){
  rnd = rnorm(n=1, mean = 0, sd = 1)
  if(rnd < 0){
    # in R you can specify nothing instead of specifiying 'pass'
    } else {
    total =+ rnd }
}
  
total
```

</div>
</div>
</div>


# Dealing with string

https://thomas-cokelaer.info/tutorials/python/strings.html


