<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Arrays/Vectors</title>

<script src="site_libs/header-attrs-2.1/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">M1 Programming</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="2_Basics.html">Basics</a>
</li>
<li>
  <a href="3_Arrays_Vectors.html">Arrays/Vectors</a>
</li>
<li>
  <a href="4_Regex.html">Regex</a>
</li>
<li>
  <a href="5_Data_Analysis_R.html">Data Analysis (R)</a>
</li>
<li>
  <a href="5_Data_Analysis_R.html">Data Analysis (Python)</a>
</li>
<li>
  <a href="6_Efficient_Prog.html">Parallel</a>
</li>
<li>
  <a href="6_Best_practices.html">Best Pratices</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/master-ds2e/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Arrays/Vectors</h1>

</div>


<style>
div.python pre { background-color: #d0f5a9; }
</style>
<style>
div.r pre { background-color: #dfdddf; }
</style>
<p>This chapter deepens the notions of arrays and vectors seen in the ‘Basics’ chapter. In python, numpy will be the main package to deal with arrays, while in R everything is contains in the base R. The main advantage of using vectors is to vectorize operation, instead of using loops to compute a function on each elements of a list, we can simply perform it on blocks of data in a more efficient may (faster, less memory used)</p>
<p>let’s first see an example to understand th benefit of using vectorized operation :</p>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 

import numpy as np
import time 

arr = np.arange(2000000)

lst = list(range(2000000))

t = time.time()
arr_2 = arr*2
time.time() - t
## 0.014981985092163086
t = time.time()
lst_2 = [i*2  for i in lst]
time.time() - t

## 0.2532179355621338</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R

vec = c(1:2000000)

t = Sys.time()
vec_2 = vec*2
Sys.time() - t
## Time difference of 0.01096082 secs

t = Sys.time()
vec_2_loop &lt;- rep(0,length(vec))
for(i in 1:length(vec)){
  vec_2_loop[i] = vec[i]*2
    }
Sys.time() - t
## Time difference of 0.4010119 secs</code></pre>
</div>
</div>
</div>
<div id="dealing-with-arrays" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Dealing with Arrays</h1>
<div id="random-array" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Random array</h2>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 

#generate an array
arr = np.random.randn(4,5)

arr

# vectorise calculation
## array([[ 1.70197547, -1.2704916 , -0.79325489, -0.50608175,  0.58215124],
##        [-0.1809559 ,  0.70211991, -0.24292755,  0.6522302 , -0.09317269],
##        [ 0.17352726, -0.07622003, -0.38586812,  0.75767914,  2.10534183],
##        [ 0.46638356, -0.56482234, -0.54625319,  1.2808873 ,  0.58554601]])
arr+arr**2

# show dimension
## array([[ 4.59869596,  0.34365731, -0.16400157, -0.24996301,  0.92105131],
##        [-0.14821086,  1.19509227, -0.18391376,  1.07763444, -0.08449154],
##        [ 0.20363897, -0.07041054, -0.23697391,  1.33175683,  6.53780606],
##        [ 0.68389719, -0.24579806, -0.24786064,  2.92155956,  0.92841013]])
arr.shape
## (4, 5)</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R

#generate a matrix
mat &lt;- matrix(runif(4*5),4,5)

mat
##           [,1]      [,2]       [,3]      [,4]      [,5]
## [1,] 0.1296858 0.2981862 0.06679001 0.4401434 0.3064526
## [2,] 0.3033357 0.8335709 0.31013267 0.1040222 0.8795535
## [3,] 0.9099030 0.3906364 0.05916465 0.3861523 0.0278680
## [4,] 0.8223938 0.9836415 0.68892725 0.5882701 0.2725045

# vectorise calculation
mat+mat**2
##           [,1]      [,2]       [,3]      [,4]       [,5]
## [1,] 0.1465042 0.3871013 0.07125092 0.6338696 0.40036578
## [2,] 0.3953483 1.5284115 0.40631494 0.1148428 1.65316776
## [3,] 1.7378264 0.5432332 0.06266510 0.5352658 0.02864462
## [4,] 1.4987254 1.9511920 1.16354802 0.9343319 0.34676313

# show dimension
dim(mat)
## [1] 4 5</code></pre>
</div>
</div>
</div>
</div>
<div id="array-oriented-programming" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Array-Oriented Programming</h2>
<p>Imagine two square matrices representing interaction between entities. Each matrix is a basic network: having interaction = 1, no interaction = 0. You want to know if two entities that are linked in one network are also linked in an other network. Instead of checking each entities interaction sequentially in a loop, one can simply use matrix to do element-wise calculation and get the same answer.</p>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 

#generate a list
list_1 = [[0,1,0,1],[1,0,1,0],[0,1,0,1],[1,0,1,0]]
network_1 = np.array(list_1)

#generate a sequence
list_2 = [[0,1,0,0],[1,0,0,0],[0,0,0,1],[0,0,1,0]]
network_2 = np.array(list_2)

network_12 = network_1*network_2
network_12
## array([[0, 1, 0, 0],
##        [1, 0, 0, 0],
##        [0, 0, 0, 1],
##        [0, 0, 1, 0]])</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R

#generate a sequence
list_1 &lt;- list(c(0,1,0,1),c(1,0,1,0),c(0,1,0,1),c(1,0,1,0))

network_1 &lt;- do.call(rbind,list_1)

#generate a sequence
list_2 = list(c(0,1,0,0),c(1,0,0,0),c(0,0,0,1),c(0,0,1,0))

network_2 &lt;- do.call(rbind,list_2)

network_12 = network_1*network_2
network_12
##      [,1] [,2] [,3] [,4]
## [1,]    0    1    0    0
## [2,]    1    0    0    0
## [3,]    0    0    0    1
## [4,]    0    0    1    0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="conditional-logic" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Conditional Logic</h1>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 

network_12 == 1
## array([[False,  True, False, False],
##        [ True, False, False, False],
##        [False, False, False,  True],
##        [False, False,  True, False]])</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R
 
network_12 == 1
##       [,1]  [,2]  [,3]  [,4]
## [1,] FALSE  TRUE FALSE FALSE
## [2,]  TRUE FALSE FALSE FALSE
## [3,] FALSE FALSE FALSE  TRUE
## [4,] FALSE FALSE  TRUE FALSE</code></pre>
</div>
</div>
</div>
<p>On thing that we often need is to modify specific value in a array that are satisfiying a condition. The first thing we want to know is which cells is satisfying the condition. In Python np.where is very common while in R we use the which function.</p>
<p>See how the execution time is changing depending on the size of the vector</p>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 

arr = np.arange(200000)


t = time.time()
results = [(i if i%2==0 else 0) for i in arr]
time.time() - t

## 0.15692853927612305
t = time.time()
results = np.where(arr%2!=0,0,arr)
time.time() - t
## 0.024953126907348633</code></pre>
<pre class="python"><code># Python 

arr = np.arange(20000000)


t = time.time()
results = [(i if i%2==0 else 0) for i in arr]
time.time() - t

## 12.667114019393921
t = time.time()
results = np.where(arr%2!=0,0,arr)
time.time() - t
## 0.8654999732971191</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R

vec &lt;- seq(1,200000)

t &lt;- Sys.time()
results &lt;- rep(0,length(vec))
for(i in 1:length(vec)){
  if(vec[i]%%2!=0){
    results[i] = 0
  } else {
    results[i] = vec[i]
  }
}
Sys.time() - t
## Time difference of 0.07969594 secs


t &lt;- Sys.time()
results &lt;- ifelse(vec%%2!=0,vec,0)
Sys.time() - t
## Time difference of 0.01498485 secs</code></pre>
<pre class="r"><code># R

vec &lt;- seq(1,20000000)

t &lt;- Sys.time()
results &lt;- rep(0,length(vec))
for(i in 1:length(vec)){
  if(vec[i]%%2!=0){
    results[i] = 0
  } else {
    results[i] = vec[i]
  }
}
Sys.time() - t
## Time difference of 6.483668 secs


t &lt;- Sys.time()
results &lt;- ifelse(vec%%2!=0,vec,0)
Sys.time() - t
## Time difference of 2.012247 secs


## other way using where

t &lt;- Sys.time()
vec[which(vec%%2==0)] = 0
Sys.time() - t 
## Time difference of 1.232617 secs</code></pre>
</div>
</div>
</div>
</div>
<div id="operation-on-array" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Operation on array</h1>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 

# nb of link
network_12.sum()/2
# same since there is only 0 and 1 
## 2.0
(network_12&gt;0).sum()/2

# share of link 
## 2.0
network_12.mean()


# nb link by entities
## 0.25
network_12.sum(axis=1)

# share of link across entities (by columns)
## array([1, 1, 1, 1])
network_12.mean(1)

## array([0.25, 0.25, 0.25, 0.25])</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R

# nb of link
sum(network_12)
## [1] 4
# same since there is only 0 and 1 
sum(network_12[which(network_12&gt;0,arr.ind = T)]) # see the arr.ind to get the two coordinates
## [1] 4

# share of link 
mean(network_12)
## [1] 0.25


# nb link by entities
apply(network_12,MARGIN = 2,FUN = sum)
## [1] 1 1 1 1

# share of link across entities (by columns)
apply(network_12,MARGIN = 2,FUN = mean)
## [1] 0.25 0.25 0.25 0.25</code></pre>
</div>
</div>
</div>
<ul>
<li>Reorder the object using sort()</li>
</ul>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 

arr = np.random.randn(10)

arr
## array([-0.80332982, -0.75681882, -1.18097666,  0.4883254 ,  0.08376877,
##         0.40133712, -0.48745261,  0.2091205 , -0.96871787, -0.48686817])
arr.sort()
</code></pre>
<pre class="python"><code># Python 

arr = np.random.randn(4,3)

arr
## array([[ 0.25470218,  0.21596867, -0.16175977],
##        [-1.3311492 ,  0.97763277,  1.86605401],
##        [ 0.13768778, -2.87062014,  0.87804886],
##        [-0.22748177,  0.07216911,  1.41422699]])
arr.sort(1)
</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R

arr &lt;- runif(10)

arr
##  [1] 0.41321184 0.60921262 0.53239812 0.77587935 0.06240621 0.34538881
##  [7] 0.77622718 0.28183229 0.16428151 0.58642137
sort(arr)
##  [1] 0.06240621 0.16428151 0.28183229 0.34538881 0.41321184 0.53239812
##  [7] 0.58642137 0.60921262 0.77587935 0.77622718</code></pre>
<pre class="r"><code># R

arr &lt;- matrix(runif(4*3),4,3)

arr
##           [,1]       [,2]      [,3]
## [1,] 0.5813943 0.30673546 0.8809896
## [2,] 0.3614639 0.30520307 0.8468506
## [3,] 0.7529683 0.04536145 0.7746907
## [4,] 0.6443070 0.87884231 0.9211857
apply(arr,MARGIN = 2, FUN = sort)
##           [,1]       [,2]      [,3]
## [1,] 0.3614639 0.04536145 0.7746907
## [2,] 0.5813943 0.30520307 0.8468506
## [3,] 0.6443070 0.30673546 0.8809896
## [4,] 0.7529683 0.87884231 0.9211857</code></pre>
</div>
</div>
</div>
</div>
<div id="algebra" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Algebra</h1>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 
from numpy.linalg import inv, qr 
 
X = np.array([[0,1,5,1],[2,1,3,1],[2,1,9,6],[7,2,1,0],[8,3,5,5]]) 
Y = np.array([0,1,2,5,4])

X
## array([[0, 1, 5, 1],
##        [2, 1, 3, 1],
##        [2, 1, 9, 6],
##        [7, 2, 1, 0],
##        [8, 3, 5, 5]])
X.T.dot(X) 
# same as 
## array([[121,  42,  71,  54],
##        [ 42,  16,  34,  23],
##        [ 71,  34, 141,  87],
##        [ 54,  23,  87,  63]])
XtX = np.dot(X.T,X)
# same as 
X.T @ X

# inverse Matrix
## array([[121,  42,  71,  54],
##        [ 42,  16,  34,  23],
##        [ 71,  34, 141,  87],
##        [ 54,  23,  87,  63]])
inv(XtX)

# Identity matrix
## array([[ 0.23199214, -0.71424803,  0.11636773, -0.09879148],
##        [-0.71424803,  2.33481201, -0.37284193,  0.27469787],
##        [ 0.11636773, -0.37284193,  0.10787934, -0.11260311],
##        [-0.09879148,  0.27469787, -0.11260311,  0.15576444]])
np.diag(np.ones(3))
## array([[1., 0., 0.],
##        [0., 1., 0.],
##        [0., 0., 1.]])</code></pre>
<pre class="python"><code># Python 

XtY = np.dot(X.T,Y)

# OLS 
Beta = inv(XtX).dot(XtY)
Beta
## array([ 1.17202187, -1.85550547,  0.42034337, -0.38384807])</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R

 
X &lt;- do.call(rbind,list(c(0,1,5,1),c(2,1,3,1),c(2,1,9,6),c(7,2,1,0),c(8,3,5,5))) 
Y &lt;- c(0,1,2,5,4)
 
t(X)%*%X
##      [,1] [,2] [,3] [,4]
## [1,]  121   42   71   54
## [2,]   42   16   34   23
## [3,]   71   34  141   87
## [4,]   54   23   87   63

XtX &lt;- t(X)%*%X

# inverse Matrix
solve(XtX)
##             [,1]       [,2]       [,3]        [,4]
## [1,]  0.23199214 -0.7142480  0.1163677 -0.09879148
## [2,] -0.71424803  2.3348120 -0.3728419  0.27469787
## [3,]  0.11636773 -0.3728419  0.1078793 -0.11260311
## [4,] -0.09879148  0.2746979 -0.1126031  0.15576444

# Identity matrix
diag(3)
##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<pre class="r"><code># R


XtY = t(X)%*%Y

# OLS 
Beta = solve(XtX) %*% XtY
Beta
##            [,1]
## [1,]  1.1720219
## [2,] -1.8555055
## [3,]  0.4203434
## [4,] -0.3838481</code></pre>
</div>
</div>
</div>
</div>
<div id="sparse" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Sparse</h1>
<p>When dealing with large array that are sparse (lot of element equalt to 0), it is inneficient to store this object as a dense matrix. Large matrix are sometimes difficult to store in the memory because they are weighty, when they dealing with sparse we can store it and do calculation with them in a very efficient way using the ‘Compressed Sparse Column’ (CSC) format. See how it change the weight of the matrix when changing the format to sparse matrix .</p>
<div class="row">
<div class="col-md-6">
<div class="python">
<pre class="python"><code># Python 
 
from scipy.sparse import csr_matrix

X = np.zeros((10000,10000))

idx = list(np.ndindex(X.shape))[np.random.randint(1,10000**2,1000)]
## Error in py_call_impl(callable, dots$args, dots$keywords): TypeError: only integer scalar arrays can be converted to a scalar index
## 
## Detailed traceback: 
##   File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
X[idx] = 1
## Error in py_call_impl(callable, dots$args, dots$keywords): NameError: name &#39;idx&#39; is not defined
## 
## Detailed traceback: 
##   File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</code></pre>
<pre class="python"><code># Python </code></pre>
</div>
</div>
<div class="col-md-6">
<div class="r">
<pre class="r"><code># R
library(Matrix)

mat = matrix(0,10000,10000)
idx = round(runif(1000,1,10000**2))

mat[idx] = 1

print(object.size(mat),units = &#39;auto&#39;)
## 762.9 Mb

sparse_mat = Matrix(mat,sparse = T)
print(object.size(sparse_mat),units = &#39;auto&#39;)
## 52.2 Kb</code></pre>
<pre class="r"><code># R

mat = matrix(0,10000,10000)
idx = round(runif(100000,1,10000**2))

mat[idx] = 1

print(object.size(mat),units = &#39;auto&#39;)
## 762.9 Mb

sparse_mat = Matrix(mat,sparse = T)
print(object.size(sparse_mat),units = &#39;auto&#39;)
## 1.2 Mb</code></pre>
</div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
